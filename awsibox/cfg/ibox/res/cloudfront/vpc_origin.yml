global:
  CloudFrontVpcOrigin:
    - ECSHttpsDefaultInternal:
        IBOX_ENABLED: False
        IBOX_OUTPUT:
          - _:
              Value: Ref(IBOX_RESNAME)
              Export: Export(IBOX_RESNAME)
        VpcOriginEndpointConfig:
          Arn: Ref("LoadBalancerApplicationInternal")
          Name: Sub(f"{IBOX_LINKED_OBJ_INDEX}" "-${AWS::StackName}-${EnvRole}-443")
          OriginProtocolPolicy: https-only
    - ECSLoadBalancerApplicationInternalHttps:
        IBOX_ENABLED: False
        IBOX_OUTPUT:
          - _:
              IBOX_ENABLED_IF: len(getattr(cfg, "CloudFrontDistribution", {})) == 0
              Value: Ref(IBOX_RESNAME)
              Export: Export(IBOX_RESNAME)
        VpcOriginEndpointConfig:
          Arn: get_expvalue('LoadBalancerApplicationInternal', 'LoadBalancerApplicationStack')
          Name: get_subvalue(f"{IBOX_LINKED_OBJ_INDEX}" "-${AWS::StackName}-${EnvRole}-${1M}", f'{IBOX_LINKED_OBJ_NAME}Port')
          OriginProtocolPolicy: https-only
          HTTPSPort: get_endvalue(f'{IBOX_LINKED_OBJ_NAME}Port')
