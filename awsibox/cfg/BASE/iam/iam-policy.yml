SSMParameterStoreBase01: &ssm_parameter_store_base_01
    Action:
      - 'kms:ListAliases'
      - 'ssm:DescribeParameters'
    Resource: '*'
SSMParameterStoreBase02: &ssm_parameter_store_base_02
    Action:
      - 'kms:Decrypt'
      - 'kms:Encrypt'
    Resource: get_expvalue('KeyParameterStore')

LogRead01: &log_read_01
    Action:
      - 'logs:Describe*'
      - 'logs:TestMetricFilter'
      - 'logs:FilterLogEvents'
      - 'logs:Get*'
    Resource: '*'

ECRRead01: &ecr_read_01
    Action:
      - 'ecr:GetAuthorizationToken'
      - 'ecr:DescribeRepositories'
      - 'ecr:ListImages'
    Resource: '*'

MetricRead01: &metric_read_01
    Action:
      - 'cloudwatch:ListMetrics'
      - 'cloudwatch:ListDashboards'
      - 'cloudwatch:GetMetricData'
      - 'cloudwatch:GetMetricStatistics'
      - 'cloudwatch:GetDashboard'
    Resource: '*'

RDSRead01: &rds_read_01
    Action:
      - 'rds:Describe*'
      - 'rds:ListTagsForResource'
      - 'rds:DownloadDBLogFilePortion'
      - 'ec2:DescribeAccountAttributes'
      - 'ec2:DescribeAvailabilityZones'
      - 'ec2:DescribeInternetGateways'
      - 'ec2:DescribeSecurityGroups'
      - 'ec2:DescribeSubnets'
      - 'ec2:DescribeVpcAttribute'
      - 'ec2:DescribeVpcs'
      - 'cloudwatch:GetMetricStatistics'
      - 'logs:DescribeLogStreams'
      - 'logs:GetLogEvents'
    Resource: '*'


global:
  IAMPolicy:
    - SSMParameterStoreBase:
        IBOX_ENABLED: False
        Export: True
        Type: Managed
        Description: 'Describe all SSM Parameters and read KMS Key'
        Statement:
          - SSMParameterStoreBase01: *ssm_parameter_store_base_01
          - SSMParameterStoreBase02: *ssm_parameter_store_base_02
    - LogRead:
        IBOX_ENABLED: False
        Export: True
        Type: Managed
        Description: 'Read CloudWatch Logs'
        Statement:
          - LogRead01: *log_read_01
    - MetricRead:
        IBOX_ENABLED: False
        Export: True
        Type: Managed
        Description: 'Read CloudWatch Metrics and DashBoard'
        Statement:
          - MetricRead01: *metric_read_01
    - ECRRead:
        IBOX_ENABLED: False
        Export: True
        Type: Managed
        Description: 'Read Grant to All Ecr Repos'
        Statement:
          - ECRRead01: *ecr_read_01
    - RDSRead:
        IBOX_ENABLED: False
        Export: True
        Type: Managed
        Description: 'AWS Managed AmazonRDSReadOnlyAccess + DownloadDBLogFilePortion'
        Statement:
          - RDSRead01: *rds_read_01
    - Developer:
        IBOX_ENABLED: False
        Export: True
        Type: Managed
        Description: "Developer"
        Statement:
          - SSMParameterStoreBase01: *ssm_parameter_store_base_01
          - SSMParameterStoreBase02: *ssm_parameter_store_base_02
          - LogRead01: *log_read_01
          - ECRRead01: *ecr_read_01
          - MetricRead01: *metric_read_01
    - BackEndTechLead01:
        IBOX_ENABLED: False
        Export: True
        Type: Managed
        Description: "BackEndTechLead01"
        Statement:
          - RDSRead01: *rds_read_01
    - BackEndDeveloper:
        IBOX_ENABLED: False
        Export: True
        Type: Managed
        Description: "BackEndDeveloper"
        Statement: {}
