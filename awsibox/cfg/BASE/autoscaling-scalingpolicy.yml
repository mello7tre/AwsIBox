AS: &as
  Enabled: None
  AutoScalingGroupName: Ref('AutoScalingGroup')

AS-Tracking: &astracking
  <<: *as
  EstimatedInstanceWarmup: 120
  PolicyType: TargetTrackingScaling

AS-Step: &asstep
  <<: *as
  AdjustmentType: ChangeInCapacity
  EstimatedInstanceWarmup: 600
  PolicyType: StepScaling

AS-TrackingCpu: &astrackingcpu
  <<: *astracking
  Type: Cpu
  TargetTrackingConfiguration:
    PredefinedMetricType: 'ASGAverageCPUUtilization'
    TargetValue: 70

AS-TrackingCustom: &astrackingcustom
  <<: *astracking
  Type: Custom
  TargetTrackingConfiguration:
    CustomizedMetricSpecification:
      Dimensions: []
      Namespace: 'AWS/EC2'

AS-StepDOWN: &asstepdown
  <<: *asstep
  StepAdjustments:
    - 0:
        MetricIntervalLowerBound: -10
        MetricIntervalUpperBound: 0
        ScalingAdjustment: -1
    - 1:
        MetricIntervalLowerBound: -20
        MetricIntervalUpperBound: -10
        ScalingAdjustment: -2
    - 2:
        MetricIntervalUpperBound: -20
        ScalingAdjustment: -2

AS-StepUP: &asstepup
  <<: *asstep
  StepAdjustments:
    - 0:
        MetricIntervalLowerBound: 0
        MetricIntervalUpperBound: 10
        ScalingAdjustment: 1
    - 1:
        MetricIntervalLowerBound: 10
        MetricIntervalUpperBound: 20
        ScalingAdjustment: 2
    - 2:
        MetricIntervalLowerBound: 20
        ScalingAdjustment: 2


global:
  AutoScalingScalingPolicy:
    - Cpu:
        <<: *astrackingcpu
    - Custom:
        <<: *astrackingcustom
    - Down:
        <<: *asstepdown
    - Up:
        <<: *asstepup
